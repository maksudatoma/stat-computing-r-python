<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="dcterms.date" content="2023-04-05">
<title>Statistical Computing using R and Python - 23&nbsp; Dates and Times</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../part-wrangling/08-functional-prog.html" rel="next">
<link href="../part-wrangling/06-data-join.html" rel="prev">
<link href="../build_deps/favicon.ico" rel="icon">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><link rel="stylesheet" href="../build_deps/style.css">
</head>
<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Dates and Times</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Statistical Computing using R and Python</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/srvanderplas/stat-computing-r-python/" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../how-to-use.html" class="sidebar-item-text sidebar-link">How to Use This Book</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part-tools/00-tools-intro.html" class="sidebar-item-text sidebar-link">Part I: Tools</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-tools/01-computer-basics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Computer Basics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-tools/02-setting-up-computer.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Setting Up Your Computer</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-tools/03-scripts-notebooks.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Scripts and Notebooks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-tools/04-Rstudio-interface.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">RStudio’s Interface</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-tools/05-git-and-github.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Version Control with Git</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part-gen-prog/00-gen-prog.html" class="sidebar-item-text sidebar-link">Part II: General Programming</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-gen-prog/00-intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Introduction to Programming</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-gen-prog/01-basic-var-types.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Variables and Basic Data Types</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-gen-prog/02-prog-functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Using Functions and Libraries</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-gen-prog/03-data-struct.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Data Structures</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-gen-prog/035-matrix-calcs.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Matrix Calculations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-gen-prog/04-control-struct.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Control Structures</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-gen-prog/05-functions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Writing Functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-gen-prog/06-debugging.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Debugging</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../part-wrangling/00-wrangling.html" class="sidebar-item-text sidebar-link">Part III: Data Wrangling</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-wrangling/01-data-input.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Data Input</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-wrangling/02-basic-data-vis.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Data Visualization Basics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-wrangling/02a-eda.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Exploratory Data Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-wrangling/02b-graphics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Data Visualization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-wrangling/02c-good-graphics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Creating Good Charts</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-wrangling/03-data-cleaning.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Data Cleaning</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-wrangling/04-strings.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Working with Strings</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-wrangling/05-data-reshape.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Reshaping Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-wrangling/06-data-join.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Joining Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-wrangling/07-datetime.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Dates and Times</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-wrangling/08-functional-prog.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Functional Programming</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../part-wrangling/09-spatial-formats.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Spatial data</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../graveyard.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Other Topics</span></a>
  </div>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#fa-bullseye-objectives" id="toc-fa-bullseye-objectives" class="nav-link active" data-scroll-target="#fa-bullseye-objectives"><span class="toc-section-number">23.1</span>  <i class="fa-solid fa-bullseye" aria-label="bullseye"></i> Objectives</a></li>
  <li><a href="#why-dates-and-times-are-hard" id="toc-why-dates-and-times-are-hard" class="nav-link" data-scroll-target="#why-dates-and-times-are-hard"><span class="toc-section-number">23.2</span>  Why Dates and Times are hard</a></li>
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started"><span class="toc-section-number">23.3</span>  Getting Started</a></li>
  <li>
<a href="#creating-dates-and-times" id="toc-creating-dates-and-times" class="nav-link" data-scroll-target="#creating-dates-and-times"><span class="toc-section-number">23.4</span>  Creating Dates and Times</a>
  <ul class="collapse">
<li><a href="#creation-from-strings" id="toc-creation-from-strings" class="nav-link" data-scroll-target="#creation-from-strings"><span class="toc-section-number">23.4.1</span>  Creation from Strings</a></li>
  <li><a href="#creation-from-components" id="toc-creation-from-components" class="nav-link" data-scroll-target="#creation-from-components"><span class="toc-section-number">23.4.2</span>  Creation from Components</a></li>
  <li><a href="#creation-from-other-objects" id="toc-creation-from-other-objects" class="nav-link" data-scroll-target="#creation-from-other-objects"><span class="toc-section-number">23.4.3</span>  Creation from Other Objects</a></li>
  </ul>
</li>
  <li>
<a href="#working-with-dates-and-times" id="toc-working-with-dates-and-times" class="nav-link" data-scroll-target="#working-with-dates-and-times"><span class="toc-section-number">23.5</span>  Working with Dates and Times</a>
  <ul class="collapse">
<li><a href="#time-zones" id="toc-time-zones" class="nav-link" data-scroll-target="#time-zones"><span class="toc-section-number">23.5.1</span>  Time Zones</a></li>
  <li><a href="#time-spans" id="toc-time-spans" class="nav-link" data-scroll-target="#time-spans"><span class="toc-section-number">23.5.2</span>  Time Spans</a></li>
  </ul>
</li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="toc-section-number">23.6</span>  References</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/srvanderplas/stat-computing-r-python/edit/main/part-wrangling/07-datetime.qmd" class="toc-action">Edit this page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-datetime" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Dates and Times</span></span></h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 5, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header><section id="fa-bullseye-objectives" class="level2" data-number="23.1"><h2 data-number="23.1" class="anchored" data-anchor-id="fa-bullseye-objectives">
<span class="header-section-number">23.1</span> <i class="fa-solid fa-bullseye" aria-label="bullseye"></i> Objectives</h2>
<ul>
<li>Understand the complexities of working with datetime data</li>
<li>Create datetime formatted data from character and numeric encodings</li>
<li>Format/print datetime data in the desired format</li>
</ul></section><section id="why-dates-and-times-are-hard" class="level2" data-number="23.2"><h2 data-number="23.2" class="anchored" data-anchor-id="why-dates-and-times-are-hard">
<span class="header-section-number">23.2</span> Why Dates and Times are hard</h2>
<p>I’m going to let Tom Scott deliver this portion of the material for me, as his times and timezones video is excellent and entertaining.</p>
<div class="youtube-video-container">
<iframe src="https://www.youtube.com/embed/-5wpm-gesOY" title="The Problem with Time &amp; Timezones - Computerphile" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="">
</iframe>
</div>
<p>There is also an excellent StackOverflow question <span class="citation" data-cites="freewindWhySubtractingThese2021"><a href="#ref-freewindWhySubtractingThese2021" role="doc-biblioref">[1]</a></span> and answers <span class="citation" data-cites="skeetAnswerWhySubtracting2011"><a href="#ref-borgwardtAnswerWhySubtracting2011" role="doc-biblioref">[3]</a></span> demonstrating exactly how times and time zones can get very confusing even in relatively simple circumstances.</p>
<p>Long story short, we will be using libraries in R and python which handle some of these complexities for us, because dates, times, and timezones are <strong>hard</strong> and we <em>really</em> don’t want to know exactly how hard they are. The libraries I’ve chosen for this are <code>datetime</code> in Python (used by Pandas), and <code>lubridate</code> in R.</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Try It Out - Getting Set up
</div>
</div>
<div class="callout-body-container callout-body">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Python</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">## install.packages("lubridate")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get current date/time</span></span>
<span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/now.html">today</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">## [1] "2023-04-05"</span></span>
<span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/now.html">now</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">## [1] "2023-04-05 12:56:13 CDT"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><a href="https://rawgit.com/rstudio/cheatsheets/main/lubridate.pdf">Lubridate cheat sheet</a> <a href="https://lubridate.tidyverse.org/">Lubridate documentation</a></p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install datetime</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> datetime</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>today <span class="op">=</span> datetime.date.today()</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>today</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">## datetime.date(2023, 4, 5)</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(today)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">## 2023-04-05</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>now <span class="op">=</span> datetime.datetime.now()</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>now</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">## datetime.datetime(2023, 4, 5, 12, 56, 14, 268903)</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(now)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co">## 2023-04-05 12:56:14.268903</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><a href="https://pandas.pydata.org/docs/user_guide/timeseries.html">pandas datetime documentation</a></p>
</div>
</div>
</div>
</div>
</div>
</section><section id="getting-started" class="level2" data-number="23.3"><h2 data-number="23.3" class="anchored" data-anchor-id="getting-started">
<span class="header-section-number">23.3</span> Getting Started</h2>
<p>Let’s differentiate between three types of data which refer to a point in time:</p>
<ul>
<li>a <strong>date</strong>
</li>
<li>a <strong>time</strong> within a day</li>
<li>a <strong>date-time</strong> - a specific time on a specific date</li>
</ul>
<p>Now, let’s think about all of the different ways we can specify dates. The table below has examples along with <code>strptime</code> formats that are used in both <code>R</code> and <code>python</code> for telling the computer which date format is used.</p>
<div id="tbl-formats" class="anchored">
<table class="table">
<caption>Table&nbsp;23.1: Different ways to specify dates and times.</caption>
<colgroup>
<col style="width: 11%">
<col style="width: 20%">
<col style="width: 11%">
<col style="width: 36%">
<col style="width: 18%">
</colgroup>
<thead><tr class="header">
<th style="text-align: right;"></th>
<th>Example</th>
<th>Type</th>
<th>Notes</th>
<th style="text-align: right;">
<code>strptime</code> format</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td>January 12, 2023</td>
<td>date</td>
<td>Common in US/N. America</td>
<td style="text-align: right;">%B %d, %Y</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td>12 January 2023</td>
<td>date</td>
<td>Common in Europe</td>
<td style="text-align: right;">%d %B %Y</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td>01/12/2023</td>
<td>date</td>
<td>Common in US</td>
<td style="text-align: right;">%m/%d/%Y</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td>1/12/23</td>
<td>date</td>
<td>Common in US</td>
<td style="text-align: right;">%m/%d/%y</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td>12/01/2023</td>
<td>date</td>
<td>Common in Europe/Asia</td>
<td style="text-align: right;">%d/%m/%Y</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td>2023-01-12</td>
<td>date</td>
<td>ISO 8601 standard<br>
(automatically sorts chronologically)</td>
<td style="text-align: right;">%Y-%m-%d<br>
or %F</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td>12 2023</td>
<td>date</td>
<td>day of year + year</td>
<td style="text-align: right;">%j %Y</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td>9:23 PM</td>
<td>time</td>
<td>12h time</td>
<td style="text-align: right;">%I:%M %p</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td>21:23</td>
<td>time</td>
<td>24h time (military time)</td>
<td style="text-align: right;">%H:%M<br>
or %R</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td>21:23:05</td>
<td>time</td>
<td>24h time (with seconds)</td>
<td style="text-align: right;">%H:%M:%S<br>
or %T</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11</td>
<td>2023-01-12T21:23:05</td>
<td>datetime</td>
<td>ISO 8601 international standard</td>
<td style="text-align: right;">%FT%T</td>
</tr>
</tbody>
</table>
</div>
<p>Note that rows 4 and 5 of <a href="#tbl-formats">Table&nbsp;<span>23.1</span></a> are ambiguous if you don’t know what location your data comes from - the dates could refer to December 1, 2023 or January 12, 2023. This only gets worse if you use 2-digit years.</p>
<p>There are three main ways that you might want to create a date/time <span class="citation" data-cites="grolemundDatesTimes"><a href="#ref-grolemundDatesTimes" role="doc-biblioref">[4]</a></span>:</p>
<ul>
<li>From a string</li>
<li>From individual date/time components</li>
<li>From an existing date/time object</li>
</ul></section><section id="creating-dates-and-times" class="level2" data-number="23.4"><h2 data-number="23.4" class="anchored" data-anchor-id="creating-dates-and-times">
<span class="header-section-number">23.4</span> Creating Dates and Times</h2>
<section id="creation-from-strings" class="level3" data-number="23.4.1"><h3 data-number="23.4.1" class="anchored" data-anchor-id="creation-from-strings">
<span class="header-section-number">23.4.1</span> Creation from Strings</h3>
<p>Dates and times are often stored in tabular formats as strings. In some cases, these are read in and automatically formatted as date-times, but in other situations, you have to specify the format yourself.</p>
<div class="callout-demo callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Demo: Datetimes from Strings
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let’s use some data from the US Geological Service with records of earthquakes with magnitude greater than 6 on the Richter scale that occurred between January 1, 2000 and January 1, 2023. You can pull this data yourself using https://earthquake.usgs.gov/earthquakes/map/, but you can also access a CSV of the data <a href="https://github.com/srvanderplas/datasets/raw/main/raw/earthquakes2000.csv">here</a>.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">R + lubridate</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Base R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Pandas</a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span></span>
<span><span class="va">quake</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"https://github.com/srvanderplas/datasets/raw/main/raw/earthquakes2000.csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">quake</span><span class="op">)</span></span>
<span><span class="co">## 'data.frame':    3484 obs. of  13 variables:</span></span>
<span><span class="co">##  $ X.EventID        : chr  "us7000j0n4" "nc73821036" "us6000j985" "us6000j8lp" ...</span></span>
<span><span class="co">##  $ Time             : chr  "2022-12-28T16:34:20Z" "2022-12-20T10:34:24Z" "2022-12-14T18:40:26Z" "2022-12-11T14:31:29Z" ...</span></span>
<span><span class="co">##  $ Latitude         : num  -21.3 40.5 51.6 17.2 -15.3 ...</span></span>
<span><span class="co">##  $ Longitude        : num  171 -124 179 -101 -173 ...</span></span>
<span><span class="co">##  $ Depth.km         : num  10 17.9 73 18 38 ...</span></span>
<span><span class="co">##  $ Author           : chr  "us" "nc" "us" "us" ...</span></span>
<span><span class="co">##  $ Catalog          : chr  "us" "nc" "us" "us" ...</span></span>
<span><span class="co">##  $ Contributor      : chr  "us" "nc" "us" "us" ...</span></span>
<span><span class="co">##  $ ContributorID    : chr  "us7000j0n4" "nc73821036" "us6000j985" "us6000j8lp" ...</span></span>
<span><span class="co">##  $ MagType          : chr  "mww" "mw" "mww" "mww" ...</span></span>
<span><span class="co">##  $ Magnitude        : num  6.1 6.4 6.3 6 6.8 6.1 6.2 6 7 6.9 ...</span></span>
<span><span class="co">##  $ MagAuthor        : chr  "us" "nc" "us" "us" ...</span></span>
<span><span class="co">##  $ EventLocationName: chr  "southeast of the Loyalty Islands" "15km WSW of Ferndale, CA" "Rat Islands, Aleutian Islands, Alaska" "8 km E of Técpan de Galeana, Mexico" ...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>By default, <code>read.csv</code> reads the time information in as a character variable.</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org">readr</a></span><span class="op">)</span></span>
<span><span class="va">quake2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"https://github.com/srvanderplas/datasets/raw/main/raw/earthquakes2000.csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">quake2</span><span class="op">)</span></span>
<span><span class="co">## spc_tbl_ [3,484 × 13] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">##  $ #EventID         : chr [1:3484] "us7000j0n4" "nc73821036" "us6000j985" "us6000j8lp" ...</span></span>
<span><span class="co">##  $ Time             : POSIXct[1:3484], format: "2022-12-28 16:34:20" "2022-12-20 10:34:24" ...</span></span>
<span><span class="co">##  $ Latitude         : num [1:3484] -21.3 40.5 51.6 17.2 -15.3 ...</span></span>
<span><span class="co">##  $ Longitude        : num [1:3484] 171 -124 179 -101 -173 ...</span></span>
<span><span class="co">##  $ Depth/km         : num [1:3484] 10 17.9 73 18 38 ...</span></span>
<span><span class="co">##  $ Author           : chr [1:3484] "us" "nc" "us" "us" ...</span></span>
<span><span class="co">##  $ Catalog          : chr [1:3484] "us" "nc" "us" "us" ...</span></span>
<span><span class="co">##  $ Contributor      : chr [1:3484] "us" "nc" "us" "us" ...</span></span>
<span><span class="co">##  $ ContributorID    : chr [1:3484] "us7000j0n4" "nc73821036" "us6000j985" "us6000j8lp" ...</span></span>
<span><span class="co">##  $ MagType          : chr [1:3484] "mww" "mw" "mww" "mww" ...</span></span>
<span><span class="co">##  $ Magnitude        : num [1:3484] 6.1 6.4 6.3 6 6.8 6.1 6.2 6 7 6.9 ...</span></span>
<span><span class="co">##  $ MagAuthor        : chr [1:3484] "us" "nc" "us" "us" ...</span></span>
<span><span class="co">##  $ EventLocationName: chr [1:3484] "southeast of the Loyalty Islands" "15km WSW of Ferndale, CA" "Rat Islands, Aleutian Islands, Alaska" "8 km E of Técpan de Galeana, Mexico" ...</span></span>
<span><span class="co">##  - attr(*, "spec")=</span></span>
<span><span class="co">##   .. cols(</span></span>
<span><span class="co">##   ..   `#EventID` = col_character(),</span></span>
<span><span class="co">##   ..   Time = col_datetime(format = ""),</span></span>
<span><span class="co">##   ..   Latitude = col_double(),</span></span>
<span><span class="co">##   ..   Longitude = col_double(),</span></span>
<span><span class="co">##   ..   `Depth/km` = col_double(),</span></span>
<span><span class="co">##   ..   Author = col_character(),</span></span>
<span><span class="co">##   ..   Catalog = col_character(),</span></span>
<span><span class="co">##   ..   Contributor = col_character(),</span></span>
<span><span class="co">##   ..   ContributorID = col_character(),</span></span>
<span><span class="co">##   ..   MagType = col_character(),</span></span>
<span><span class="co">##   ..   Magnitude = col_double(),</span></span>
<span><span class="co">##   ..   MagAuthor = col_character(),</span></span>
<span><span class="co">##   ..   EventLocationName = col_character()</span></span>
<span><span class="co">##   .. )</span></span>
<span><span class="co">##  - attr(*, "problems")=&lt;externalptr&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>However, if we use <code><a href="https://readr.tidyverse.org/reference/read_delim.html">readr::read_csv</a></code>, the data is correctly read in as a <code>POSIXct</code> format, which is how R indicates that something is a datetime object.</p>
<p>If we want to directly convert the Time column in <code>quake</code> to a datetime, we can use the <code>lubridate</code> package, which has helper functions <code>ymd_hms</code>, <code>ymd</code>, and more. Our data is formatted in ISO 8601 standard format, which means we can easily read it in with <code><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html">ymd_hms()</a></code> .</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="va">quake</span> <span class="op">&lt;-</span> <span class="va">quake</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>dateTime <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html">ymd_hms</a></span><span class="op">(</span><span class="va">Time</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">quake</span><span class="op">)</span></span>
<span><span class="co">## 'data.frame':    3484 obs. of  14 variables:</span></span>
<span><span class="co">##  $ X.EventID        : chr  "us7000j0n4" "nc73821036" "us6000j985" "us6000j8lp" ...</span></span>
<span><span class="co">##  $ Time             : chr  "2022-12-28T16:34:20Z" "2022-12-20T10:34:24Z" "2022-12-14T18:40:26Z" "2022-12-11T14:31:29Z" ...</span></span>
<span><span class="co">##  $ Latitude         : num  -21.3 40.5 51.6 17.2 -15.3 ...</span></span>
<span><span class="co">##  $ Longitude        : num  171 -124 179 -101 -173 ...</span></span>
<span><span class="co">##  $ Depth.km         : num  10 17.9 73 18 38 ...</span></span>
<span><span class="co">##  $ Author           : chr  "us" "nc" "us" "us" ...</span></span>
<span><span class="co">##  $ Catalog          : chr  "us" "nc" "us" "us" ...</span></span>
<span><span class="co">##  $ Contributor      : chr  "us" "nc" "us" "us" ...</span></span>
<span><span class="co">##  $ ContributorID    : chr  "us7000j0n4" "nc73821036" "us6000j985" "us6000j8lp" ...</span></span>
<span><span class="co">##  $ MagType          : chr  "mww" "mw" "mww" "mww" ...</span></span>
<span><span class="co">##  $ Magnitude        : num  6.1 6.4 6.3 6 6.8 6.1 6.2 6 7 6.9 ...</span></span>
<span><span class="co">##  $ MagAuthor        : chr  "us" "nc" "us" "us" ...</span></span>
<span><span class="co">##  $ EventLocationName: chr  "southeast of the Loyalty Islands" "15km WSW of Ferndale, CA" "Rat Islands, Aleutian Islands, Alaska" "8 km E of Técpan de Galeana, Mexico" ...</span></span>
<span><span class="co">##  $ dateTime         : POSIXct, format: "2022-12-28 16:34:20" "2022-12-20 10:34:24" ...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can then test whether <code>quake$dateTime</code> is the same as <code>quake2$Time</code> :</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span><span class="op">(</span><span class="va">quake2</span><span class="op">$</span><span class="va">Time</span>, <span class="va">quake</span><span class="op">$</span><span class="va">dateTime</span><span class="op">)</span></span>
<span><span class="co">## [1] TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>So in the case that your data is not automatically read in as a date-time, you can use the helper functions from lubridate (<code>ymd_hms</code>, <code>ymd</code>, <code>mdy</code>, …) to convert strings to date-time data.</p>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>As lovely as the lubridate package is, there are some situations where using the tidyverse may not be desirable or even allowed. It is helpful to know how to solve this problem in base R, even if 99% of the time we can use the much easier-to-remember lubridate package.</p>
<p>In this case, we would use the <code>as.POSIXct</code> function, and we probably want to have the reference page up (run <code><a href="https://rdrr.io/r/base/strptime.html">?strptime</a></code> in the R console to pull up the help page).</p>
<p>We’ll need to get the codes that tell R what format our datetimes use - you can use <a href="#tbl-formats">Table&nbsp;<span>23.1</span></a>, if you like, or read the <code>as.POSIXct</code> help page to see all possible format codes.</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">quake</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"https://github.com/srvanderplas/datasets/raw/main/raw/earthquakes2000.csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">quake</span><span class="op">)</span></span>
<span><span class="co">## 'data.frame':    3484 obs. of  13 variables:</span></span>
<span><span class="co">##  $ X.EventID        : chr  "us7000j0n4" "nc73821036" "us6000j985" "us6000j8lp" ...</span></span>
<span><span class="co">##  $ Time             : chr  "2022-12-28T16:34:20Z" "2022-12-20T10:34:24Z" "2022-12-14T18:40:26Z" "2022-12-11T14:31:29Z" ...</span></span>
<span><span class="co">##  $ Latitude         : num  -21.3 40.5 51.6 17.2 -15.3 ...</span></span>
<span><span class="co">##  $ Longitude        : num  171 -124 179 -101 -173 ...</span></span>
<span><span class="co">##  $ Depth.km         : num  10 17.9 73 18 38 ...</span></span>
<span><span class="co">##  $ Author           : chr  "us" "nc" "us" "us" ...</span></span>
<span><span class="co">##  $ Catalog          : chr  "us" "nc" "us" "us" ...</span></span>
<span><span class="co">##  $ Contributor      : chr  "us" "nc" "us" "us" ...</span></span>
<span><span class="co">##  $ ContributorID    : chr  "us7000j0n4" "nc73821036" "us6000j985" "us6000j8lp" ...</span></span>
<span><span class="co">##  $ MagType          : chr  "mww" "mw" "mww" "mww" ...</span></span>
<span><span class="co">##  $ Magnitude        : num  6.1 6.4 6.3 6 6.8 6.1 6.2 6 7 6.9 ...</span></span>
<span><span class="co">##  $ MagAuthor        : chr  "us" "nc" "us" "us" ...</span></span>
<span><span class="co">##  $ EventLocationName: chr  "southeast of the Loyalty Islands" "15km WSW of Ferndale, CA" "Rat Islands, Aleutian Islands, Alaska" "8 km E of Técpan de Galeana, Mexico" ...</span></span>
<span><span class="va">quake</span><span class="op">$</span><span class="va">dateTime2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="va">quake</span><span class="op">$</span><span class="va">Time</span>, <span class="st">"%Y-%m-%dT%H:%M:%S"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span><span class="op">(</span><span class="va">quake</span><span class="op">$</span><span class="va">dateTime</span>, <span class="va">quake</span><span class="op">$</span><span class="va">dateTime2</span><span class="op">)</span></span>
<span><span class="co">## [1] TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>So using <code>as.POSIXct</code> we do not get the convenient handling of time zones that we got using <code>ymd_hms</code>, but we can set the time zone explicitly if we want to do so.</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">quake</span><span class="op">$</span><span class="va">dateTime2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="va">quake</span><span class="op">$</span><span class="va">Time</span>, tz <span class="op">=</span> <span class="st">"UTC"</span>, <span class="st">"%Y-%m-%dT%H:%M:%S"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span><span class="op">(</span><span class="va">quake</span><span class="op">$</span><span class="va">dateTime</span>, <span class="va">quake</span><span class="op">$</span><span class="va">dateTime2</span><span class="op">)</span></span>
<span><span class="co">## [1] TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<p>In pandas, we can use the <code>to_datetime</code> method. If the format is not specified, pandas will try to guess the date-time format; in this case, the guess works, but if not, you can provide a <code>format = …</code> argument that works the same way as R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>quake <span class="op">=</span> pd.read_csv(<span class="st">"https://github.com/srvanderplas/datasets/raw/main/raw/earthquakes2000.csv"</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>quake.dtypes</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">## #EventID              object</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">## Time                  object</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">## Latitude             float64</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">## Longitude            float64</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">## Depth/km             float64</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">## Author                object</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">## Catalog               object</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">## Contributor           object</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co">## ContributorID         object</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co">## MagType               object</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co">## Magnitude            float64</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co">## MagAuthor             object</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co">## EventLocationName     object</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="co">## dtype: object</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>quake.Time[<span class="dv">0</span>:<span class="dv">10</span>]</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to datetime</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="co">## 0    2022-12-28T16:34:20Z</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="co">## 1    2022-12-20T10:34:24Z</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="co">## 2    2022-12-14T18:40:26Z</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="co">## 3    2022-12-11T14:31:29Z</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="co">## 4    2022-12-04T19:24:15Z</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="co">## 5    2022-11-23T01:08:15Z</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="co">## 6    2022-11-22T16:39:05Z</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="co">## 7    2022-11-22T02:37:57Z</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="co">## 8    2022-11-22T02:03:06Z</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a><span class="co">## 9    2022-11-18T13:37:08Z</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a><span class="co">## Name: Time, dtype: object</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>quake[<span class="st">'dateTime'</span>] <span class="op">=</span> pd.to_datetime(quake.Time)</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>quake.dtypes</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a><span class="co">## #EventID                          object</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a><span class="co">## Time                              object</span></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a><span class="co">## Latitude                         float64</span></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a><span class="co">## Longitude                        float64</span></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a><span class="co">## Depth/km                         float64</span></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a><span class="co">## Author                            object</span></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a><span class="co">## Catalog                           object</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a><span class="co">## Contributor                       object</span></span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a><span class="co">## ContributorID                     object</span></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a><span class="co">## MagType                           object</span></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a><span class="co">## Magnitude                        float64</span></span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a><span class="co">## MagAuthor                         object</span></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a><span class="co">## EventLocationName                 object</span></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a><span class="co">## dateTime             datetime64[ns, UTC]</span></span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a><span class="co">## dtype: object</span></span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>quake.dateTime[<span class="dv">0</span>:<span class="dv">10</span>]</span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to datetime</span></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a><span class="co">## 0   2022-12-28 16:34:20+00:00</span></span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a><span class="co">## 1   2022-12-20 10:34:24+00:00</span></span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a><span class="co">## 2   2022-12-14 18:40:26+00:00</span></span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a><span class="co">## 3   2022-12-11 14:31:29+00:00</span></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a><span class="co">## 4   2022-12-04 19:24:15+00:00</span></span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a><span class="co">## 5   2022-11-23 01:08:15+00:00</span></span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a><span class="co">## 6   2022-11-22 16:39:05+00:00</span></span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a><span class="co">## 7   2022-11-22 02:37:57+00:00</span></span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a><span class="co">## 8   2022-11-22 02:03:06+00:00</span></span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a><span class="co">## 9   2022-11-18 13:37:08+00:00</span></span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a><span class="co">## Name: dateTime, dtype: datetime64[ns, UTC]</span></span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a>quake[<span class="st">'dateTime2'</span>] <span class="op">=</span> pd.to_datetime(quake.Time, <span class="bu">format</span> <span class="op">=</span> <span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st">T%H:%M:%S"</span>)</span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a>quake.dtypes</span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a><span class="co">## #EventID                          object</span></span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a><span class="co">## Time                              object</span></span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a><span class="co">## Latitude                         float64</span></span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a><span class="co">## Longitude                        float64</span></span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a><span class="co">## Depth/km                         float64</span></span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a><span class="co">## Author                            object</span></span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a><span class="co">## Catalog                           object</span></span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a><span class="co">## Contributor                       object</span></span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a><span class="co">## ContributorID                     object</span></span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a><span class="co">## MagType                           object</span></span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a><span class="co">## Magnitude                        float64</span></span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a><span class="co">## MagAuthor                         object</span></span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a><span class="co">## EventLocationName                 object</span></span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true" tabindex="-1"></a><span class="co">## dateTime             datetime64[ns, UTC]</span></span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true" tabindex="-1"></a><span class="co">## dateTime2            datetime64[ns, UTC]</span></span>
<span id="cb10-80"><a href="#cb10-80" aria-hidden="true" tabindex="-1"></a><span class="co">## dtype: object</span></span>
<span id="cb10-81"><a href="#cb10-81" aria-hidden="true" tabindex="-1"></a>quake.dateTime2[<span class="dv">0</span>:<span class="dv">10</span>]</span>
<span id="cb10-82"><a href="#cb10-82" aria-hidden="true" tabindex="-1"></a><span class="co">## 0   2022-12-28 16:34:20+00:00</span></span>
<span id="cb10-83"><a href="#cb10-83" aria-hidden="true" tabindex="-1"></a><span class="co">## 1   2022-12-20 10:34:24+00:00</span></span>
<span id="cb10-84"><a href="#cb10-84" aria-hidden="true" tabindex="-1"></a><span class="co">## 2   2022-12-14 18:40:26+00:00</span></span>
<span id="cb10-85"><a href="#cb10-85" aria-hidden="true" tabindex="-1"></a><span class="co">## 3   2022-12-11 14:31:29+00:00</span></span>
<span id="cb10-86"><a href="#cb10-86" aria-hidden="true" tabindex="-1"></a><span class="co">## 4   2022-12-04 19:24:15+00:00</span></span>
<span id="cb10-87"><a href="#cb10-87" aria-hidden="true" tabindex="-1"></a><span class="co">## 5   2022-11-23 01:08:15+00:00</span></span>
<span id="cb10-88"><a href="#cb10-88" aria-hidden="true" tabindex="-1"></a><span class="co">## 6   2022-11-22 16:39:05+00:00</span></span>
<span id="cb10-89"><a href="#cb10-89" aria-hidden="true" tabindex="-1"></a><span class="co">## 7   2022-11-22 02:37:57+00:00</span></span>
<span id="cb10-90"><a href="#cb10-90" aria-hidden="true" tabindex="-1"></a><span class="co">## 8   2022-11-22 02:03:06+00:00</span></span>
<span id="cb10-91"><a href="#cb10-91" aria-hidden="true" tabindex="-1"></a><span class="co">## 9   2022-11-18 13:37:08+00:00</span></span>
<span id="cb10-92"><a href="#cb10-92" aria-hidden="true" tabindex="-1"></a><span class="co">## Name: dateTime2, dtype: datetime64[ns, UTC]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Try it Out - Datetimes from Strings
</div>
</div>
<div class="callout-body-container callout-body">
<p>It’s usually important for new parents to keep a log of the new baby’s feeds, to ensure that the baby is getting enough liquids and isn’t getting dehydrated. I used an app to keep track of my daughter’s feeds from birth (though here, we’ll only work with <a href="https://raw.githubusercontent.com/srvanderplas/datasets/main/raw/feeds_first_month.csv">the first 3 months of data</a>), and it used a reasonable, if not standard way to store dates and times.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Problem</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">R solution</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Python solution</a></li>
</ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>Take a look at the <a href="https://raw.githubusercontent.com/srvanderplas/datasets/main/raw/feeds_first_month.csv">first month of feeds</a>. Note that these data are from August 7, 2021 to November 4, 2021 – roughly baby’s first 90 days.</p>
<ol type="1">
<li>Convert Start and End to datetime variables</li>
<li>Can you plot the feeds somehow?</li>
<li>Can you do arithmetic with datetimes to see if there are any user entry errors?<br>
This data was created by a <em>highly</em> unreliable and error prone couple of individuals – specifically, sleep-deprived new parents.</li>
</ol>
<p>To do this, you may need to figure out how to specify a non-standard date format in R and/or python. The <code>parse_date_time</code> function is useful in R, and <code>pd.to_datetime()</code> takes a format argument in python.</p>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>First, let’s read the data in and explore a bit.</p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org">readr</a></span><span class="op">)</span></span>
<span><span class="va">feeds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/srvanderplas/datasets/main/raw/feeds_initial.csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">feeds</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 6 × 6</span></span>
<span><span class="co">##      id Start               End       Type  `Quantity (oz)` `Quantity (ml or g)`</span></span>
<span><span class="co">##   &lt;dbl&gt; &lt;chr&gt;               &lt;chr&gt;     &lt;chr&gt;           &lt;dbl&gt;                &lt;dbl&gt;</span></span>
<span><span class="co">## 1  1368 20:03:30 11-04-2021 20:45:21… Brea…              NA                   NA</span></span>
<span><span class="co">## 2  1366 18:00:29 11-04-2021 18:18:29… Brea…              NA                   NA</span></span>
<span><span class="co">## 3  1365 16:27:29 11-04-2021 17:03:26… Brea…              NA                   NA</span></span>
<span><span class="co">## 4  1364 14:30:01 11-04-2021 14:42:05… Brea…              NA                   NA</span></span>
<span><span class="co">## 5  1367 12:48:29 11-04-2021 13:50:29… Bott…               3                   88</span></span>
<span><span class="co">## 6  1363 10:59:18 11-04-2021 11:15:18… Bott…               3                   88</span></span>
<span></span>
<span><span class="co"># Looks like %H:%M:%S %m-%d-%Y format.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It looks like the data is stored in a format where the time (<code>%H:%M:%S</code>) is first and the date (<code>%m-%d-%Y</code>) is second. We can use the <code>parse_date_time</code> function in lubridate</p>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">feeds</span> <span class="op">&lt;-</span> <span class="va">feeds</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Start <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/parse_date_time.html">parse_date_time</a></span><span class="op">(</span><span class="va">Start</span>, orders <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"%H:%M:%S %m-%d-%Y"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         End <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/parse_date_time.html">parse_date_time</a></span><span class="op">(</span><span class="va">End</span>, orders <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"%H:%M:%S %m-%d-%Y"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s then explore how we might plot this data:</p>
<div class="cell" data-fig.caption="Feeds in the first 90 days of an infant's life.">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">feeds</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="va">Start</span>, xmax <span class="op">=</span> <span class="va">End</span>, fill <span class="op">=</span> <span class="va">Type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_rect</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="fl">1</span>, ymax <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Specify default aes</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Bottle"</span> <span class="op">=</span> <span class="st">"cornflowerblue"</span>, <span class="st">"Breast"</span> <span class="op">=</span> <span class="st">"pink"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07-datetime_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="1800"></p>
</div>
</div>
<div class="cell" data-fig.caption="Feeds in the first 90 days of an infant's life, by hour of the day.">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">feeds</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>day <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/round_date.html">floor_date</a></span><span class="op">(</span><span class="va">Start</span>, <span class="st">"day"</span><span class="op">)</span>,</span>
<span>         hour_start <span class="op">=</span> <span class="va">Start</span> <span class="op">-</span> <span class="va">day</span>,</span>
<span>         hour_end <span class="op">=</span> <span class="va">End</span> <span class="op">-</span> <span class="va">day</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"hour"</span><span class="op">)</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">.</span>, units <span class="op">=</span> <span class="st">"hours"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>doy <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/day.html">yday</a></span><span class="op">(</span><span class="va">day</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">day</span>, ymax <span class="op">=</span> <span class="va">day</span><span class="op">+</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/period.html">days</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, xmin <span class="op">=</span> <span class="va">hour_start</span>, xmax <span class="op">=</span> <span class="va">hour_end</span>, fill <span class="op">=</span> <span class="va">Type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_rect</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Specify default aes</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Bottle"</span> <span class="op">=</span> <span class="st">"cornflowerblue"</span>, <span class="st">"Breast"</span> <span class="op">=</span> <span class="st">"pink"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span><span class="st">"Hour of the day"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07-datetime_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="1800"></p>
</div>
</div>
<p>We can also calculate the duration of each feed and look at the distributions for each type of feed.</p>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">feeds</span> <span class="op">&lt;-</span> <span class="va">feeds</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>duration <span class="op">=</span> <span class="va">End</span> <span class="op">-</span> <span class="va">Start</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">feeds</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">duration</span>, fill <span class="op">=</span> <span class="va">Type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Bottle"</span> <span class="op">=</span> <span class="st">"cornflowerblue"</span>, <span class="st">"Breast"</span> <span class="op">=</span> <span class="st">"pink"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Feed duration, in seconds"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Type</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07-datetime_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="2100"></p>
</div>
</div>
<p>We can see a few suspiciously long feeds - 9000 seconds is 2.5 hours, which is not unheard of for a baby to breastfeed, but would be an exceptionally long bottle feed (unless a parent fell asleep before hitting “stop” on the feed, which is much more likely).</p>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<p>First, let’s read the data in and explore a bit.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>feeds <span class="op">=</span> pd.read_csv(<span class="st">"https://raw.githubusercontent.com/srvanderplas/datasets/main/raw/feeds_initial.csv"</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>feeds.head()</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Looks like %H:%M:%S %m-%d-%Y format.</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co">##      id                Start  ... Quantity (oz) Quantity (ml or g)</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co">## 0  1368  20:03:30 11-04-2021  ...           NaN                NaN</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co">## 1  1366  18:00:29 11-04-2021  ...           NaN                NaN</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co">## 2  1365  16:27:29 11-04-2021  ...           NaN                NaN</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co">## 3  1364  14:30:01 11-04-2021  ...           NaN                NaN</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co">## 4  1367  12:48:29 11-04-2021  ...           3.0               88.0</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="co">## </span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co">## [5 rows x 6 columns]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It looks like the data is stored in a format where the time (<code>%H:%M:%S</code>) is first and the date (<code>%m-%d-%Y</code>) is second. We can use the format argument to <code>pd.to_datetime</code> to specify this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>feeds[<span class="st">"Start"</span>] <span class="op">=</span> pd.to_datetime(feeds.Start, <span class="bu">format</span> <span class="op">=</span> <span class="st">"%H:%M:%S %m-</span><span class="sc">%d</span><span class="st">-%Y"</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>feeds[<span class="st">"End"</span>] <span class="op">=</span> pd.to_datetime(feeds.End, <span class="bu">format</span> <span class="op">=</span> <span class="st">"%H:%M:%S %m-</span><span class="sc">%d</span><span class="st">-%Y"</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>feeds.head()</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">##      id               Start  ... Quantity (oz) Quantity (ml or g)</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co">## 0  1368 2021-11-04 20:03:30  ...           NaN                NaN</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co">## 1  1366 2021-11-04 18:00:29  ...           NaN                NaN</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co">## 2  1365 2021-11-04 16:27:29  ...           NaN                NaN</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co">## 3  1364 2021-11-04 14:30:01  ...           NaN                NaN</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co">## 4  1367 2021-11-04 12:48:29  ...           3.0               88.0</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co">## </span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co">## [5 rows x 6 columns]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In Python, it is helpful to do a bit of transformation first - this is partly because I’m not as good with Python plotting systems.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> datetime <span class="im">as</span> dt</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>feeds[<span class="st">"day"</span>] <span class="op">=</span> feeds.Start.dt.strftime(<span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st">"</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>feeds[<span class="st">"day"</span>] <span class="op">=</span> pd.to_datetime(feeds.day, <span class="bu">format</span> <span class="op">=</span> <span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st">"</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>feeds[<span class="st">"day_end"</span>] <span class="op">=</span> feeds.day <span class="op">+</span> dt.timedelta(days <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>feeds[<span class="st">"time_start"</span>] <span class="op">=</span> feeds.Start <span class="op">-</span> feeds.day</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>feeds[<span class="st">"time_end"</span>] <span class="op">=</span> feeds.End <span class="op">-</span> feeds.day</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>feeds[<span class="st">"duration"</span>] <span class="op">=</span> feeds.time_end <span class="op">-</span> feeds.time_start</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that as of January 2023, RStudio does not correctly display timedelta data types in python. They show up as NAs in the table, but are printed fine in the console. Don’t spend hours trying to figure out why it isn’t working – it’s bad enough that I did.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotnine <span class="im">import</span> <span class="op">*</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  ggplot(feeds, aes(xmin <span class="op">=</span> <span class="st">"Start"</span>, xmax <span class="op">=</span> <span class="st">"End"</span>, fill <span class="op">=</span> <span class="st">"Type"</span>)) <span class="op">+</span> </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  geom_rect(aes(ymin <span class="op">=</span> <span class="dv">1</span>, ymax <span class="op">=</span> <span class="dv">2</span>)) <span class="op">+</span> </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  scale_fill_manual(values <span class="op">=</span> [<span class="st">"cornflowerblue"</span>, <span class="st">"pink"</span>]) <span class="op">+</span> </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  theme_bw() <span class="op">+</span> scale_y_continuous(breaks <span class="op">=</span> [])</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co">## &lt;ggplot: (8768558096451)&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07-datetime_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="614"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotnine <span class="im">import</span> <span class="op">*</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  ggplot(feeds, aes(xmin <span class="op">=</span> <span class="st">"time_start"</span>, xmax <span class="op">=</span> <span class="st">"time_end"</span>, ymin <span class="op">=</span> <span class="st">"day"</span>, ymax <span class="op">=</span> <span class="st">"day_end"</span>, fill <span class="op">=</span> <span class="st">"Type"</span>)) <span class="op">+</span> </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  geom_rect() <span class="op">+</span> </span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  scale_fill_manual(values <span class="op">=</span> [<span class="st">"cornflowerblue"</span>, <span class="st">"pink"</span>]) <span class="op">+</span> </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  theme_bw()</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="co">## &lt;ggplot: (8768543291371)&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07-datetime_files/figure-html/unnamed-chunk-20-3.png" class="img-fluid" width="614"></p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="creation-from-components" class="level3" data-number="23.4.2"><h3 data-number="23.4.2" class="anchored" data-anchor-id="creation-from-components">
<span class="header-section-number">23.4.2</span> Creation from Components</h3>
<p>Sometimes, instead of a single string, you’ll have the individual components of the date-time spread across columns. The <code>nycflights13</code> data is a good example of this.</p>
<div class="callout-demo callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Demo: Datetimes from Components
</div>
</div>
<div class="callout-body-container callout-body">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">R + lubridate</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Base R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">Python</a></li>
</ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<p>In <code>lubridate</code>, the <code><a href="https://lubridate.tidyverse.org/reference/make_datetime.html">make_date()</a></code> and <code><a href="https://lubridate.tidyverse.org/reference/make_datetime.html">make_datetime()</a></code> functions can be used to create date-times from component pieces.</p>
<div class="cell">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/nycflights13">nycflights13</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">flights</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">month</span>, <span class="va">day</span>, <span class="va">hour</span>, <span class="va">minute</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 6 × 5</span></span>
<span><span class="co">##    year month   day  hour minute</span></span>
<span><span class="co">##   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">## 1  2013     1     1     5     15</span></span>
<span><span class="co">## 2  2013     1     1     5     29</span></span>
<span><span class="co">## 3  2013     1     1     5     40</span></span>
<span><span class="co">## 4  2013     1     1     5     45</span></span>
<span><span class="co">## 5  2013     1     1     6      0</span></span>
<span><span class="co">## 6  2013     1     1     5     58</span></span>
<span></span>
<span><span class="va">flights</span> <span class="op">&lt;-</span> <span class="va">flights</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>date <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/make_datetime.html">make_date</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">month</span>, <span class="va">day</span><span class="op">)</span>,</span>
<span>         datetime <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/make_datetime.html">make_datetime</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">month</span>, <span class="va">day</span>, <span class="va">hour</span>, <span class="va">minute</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">flights</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">datetime</span>, <span class="va">year</span>, <span class="va">month</span>, <span class="va">day</span>, <span class="va">hour</span>, <span class="va">minute</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 336,776 × 7</span></span>
<span><span class="co">##    date       datetime             year month   day  hour minute</span></span>
<span><span class="co">##    &lt;date&gt;     &lt;dttm&gt;              &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">##  1 2013-01-01 2013-01-01 05:15:00  2013     1     1     5     15</span></span>
<span><span class="co">##  2 2013-01-01 2013-01-01 05:29:00  2013     1     1     5     29</span></span>
<span><span class="co">##  3 2013-01-01 2013-01-01 05:40:00  2013     1     1     5     40</span></span>
<span><span class="co">##  4 2013-01-01 2013-01-01 05:45:00  2013     1     1     5     45</span></span>
<span><span class="co">##  5 2013-01-01 2013-01-01 06:00:00  2013     1     1     6      0</span></span>
<span><span class="co">##  6 2013-01-01 2013-01-01 05:58:00  2013     1     1     5     58</span></span>
<span><span class="co">##  7 2013-01-01 2013-01-01 06:00:00  2013     1     1     6      0</span></span>
<span><span class="co">##  8 2013-01-01 2013-01-01 06:00:00  2013     1     1     6      0</span></span>
<span><span class="co">##  9 2013-01-01 2013-01-01 06:00:00  2013     1     1     6      0</span></span>
<span><span class="co">## 10 2013-01-01 2013-01-01 06:00:00  2013     1     1     6      0</span></span>
<span><span class="co">## # ℹ 336,766 more rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<p>In base R, we can use the <code>ISOdate</code> function to create date times.</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flights</span><span class="op">$</span><span class="va">datetime_base</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">flights</span>, <span class="fu"><a href="https://rdrr.io/r/base/ISOdatetime.html">ISOdatetime</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">month</span>, <span class="va">day</span>, <span class="va">hour</span>, <span class="va">minute</span>, sec<span class="op">=</span> <span class="fl">0</span>, tz<span class="op">=</span><span class="st">"UTC"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span><span class="op">(</span><span class="va">flights</span><span class="op">$</span><span class="va">datetime</span>, <span class="va">flights</span><span class="op">$</span><span class="va">datetime_base</span><span class="op">)</span></span>
<span><span class="co">## [1] TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<p>In pandas, we can pass multiple columns to <code>pd.to_datetime()</code> and as long as they are named reasonably, pandas will handle the conversion. If we want to have the date but not the time for some reason, we just pass fewer columns to pandas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nycflights13 <span class="im">import</span> flights</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>flights[[<span class="st">"year"</span>, <span class="st">"month"</span>, <span class="st">"day"</span>, <span class="st">"hour"</span>, <span class="st">"minute"</span>]]</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co">##         year  month  day  hour  minute</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co">## 0       2013      1    1     5      15</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co">## 1       2013      1    1     5      29</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co">## 2       2013      1    1     5      40</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co">## 3       2013      1    1     5      45</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co">## 4       2013      1    1     6       0</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co">## ...      ...    ...  ...   ...     ...</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="co">## 336771  2013      9   30    14      55</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="co">## 336772  2013      9   30    22       0</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="co">## 336773  2013      9   30    12      10</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="co">## 336774  2013      9   30    11      59</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="co">## 336775  2013      9   30     8      40</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="co">## </span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a><span class="co">## [336776 rows x 5 columns]</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>flights[<span class="st">"date"</span>] <span class="op">=</span> pd.to_datetime(flights[[<span class="st">"year"</span>, <span class="st">"month"</span>, <span class="st">"day"</span>]])</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>flights[<span class="st">"datetime"</span>] <span class="op">=</span> pd.to_datetime(flights[[<span class="st">"year"</span>, <span class="st">"month"</span>, <span class="st">"day"</span>, <span class="st">"hour"</span>, <span class="st">"minute"</span>]])</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>flights[[<span class="st">"date"</span>, <span class="st">"datetime"</span>, <span class="st">"year"</span>, <span class="st">"month"</span>, <span class="st">"day"</span>, <span class="st">"hour"</span>, <span class="st">"minute"</span>]]</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a><span class="co">##              date            datetime  year  month  day  hour  minute</span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a><span class="co">## 0      2013-01-01 2013-01-01 05:15:00  2013      1    1     5      15</span></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a><span class="co">## 1      2013-01-01 2013-01-01 05:29:00  2013      1    1     5      29</span></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a><span class="co">## 2      2013-01-01 2013-01-01 05:40:00  2013      1    1     5      40</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a><span class="co">## 3      2013-01-01 2013-01-01 05:45:00  2013      1    1     5      45</span></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a><span class="co">## 4      2013-01-01 2013-01-01 06:00:00  2013      1    1     6       0</span></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a><span class="co">## ...           ...                 ...   ...    ...  ...   ...     ...</span></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a><span class="co">## 336771 2013-09-30 2013-09-30 14:55:00  2013      9   30    14      55</span></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a><span class="co">## 336772 2013-09-30 2013-09-30 22:00:00  2013      9   30    22       0</span></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a><span class="co">## 336773 2013-09-30 2013-09-30 12:10:00  2013      9   30    12      10</span></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a><span class="co">## 336774 2013-09-30 2013-09-30 11:59:00  2013      9   30    11      59</span></span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a><span class="co">## 336775 2013-09-30 2013-09-30 08:40:00  2013      9   30     8      40</span></span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a><span class="co">## </span></span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a><span class="co">## [336776 rows x 7 columns]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<!-- ## Creation from other objects -->
</section><section id="creation-from-other-objects" class="level3" data-number="23.4.3"><h3 data-number="23.4.3" class="anchored" data-anchor-id="creation-from-other-objects">
<span class="header-section-number">23.4.3</span> Creation from Other Objects</h3>
<p>Sometimes, you may have information in one type of variable (e.g.&nbsp;a datetime) and want to split it into a date and a time, separately.</p>
<p>Some systems store datetimes as the number of seconds from a specific point (commonly, the <strong>Unix Epoch</strong>, midnight on 1970-01-01). You may have to convert from seconds since this epoch (or some other epoch <span class="citation" data-cites="wikipediacontributorsEpochComputing2023"><a href="#ref-wikipediacontributorsEpochComputing2023" role="doc-biblioref">[5]</a></span>) to an actual date-time that is human readable.</p>
<p>If you ever have to convert dates and times that were stored in Microsoft Excel, it can be helpful to know that Microsoft stores dates as the number of days since January 1, 1900 <span class="citation" data-cites="microsoftsupportDATEVALUEFunctionMicrosoft2023"><a href="#ref-microsoftsupportDATEVALUEFunctionMicrosoft2023" role="doc-biblioref">[6]</a></span> (or if the spreadsheet was created on a Mac, January 1, 1904) <span class="citation" data-cites="elizabethmottWhyDatesCome2013"><a href="#ref-elizabethmottWhyDatesCome2013" role="doc-biblioref">[7]</a></span>. Yes, this is as confusing as it sounds. Don’t use MS Excel for handling dates <span class="citation" data-cites="caudillExcelHellCautionary2018 chris88888888ExcelStillSucks2020"><a href="#ref-caudillExcelHellCautionary2018" role="doc-biblioref">[8]</a>, <a href="#ref-chris88888888ExcelStillSucks2020" role="doc-biblioref">[9]</a></span> (or really, at all, now that you know better tools). Geneticists have actually renamed genes because Microsoft won’t fix Excel to handle dates properly <span class="citation" data-cites="vincentScientistsRenameHuman2020"><a href="#ref-vincentScientistsRenameHuman2020" role="doc-biblioref">[10]</a></span>.</p>
<div class="callout-demo callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Demo: Creation from Other Objects
</div>
</div>
<div class="callout-body-container callout-body">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">R + lubridate</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Base R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">Python</a></li>
</ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<p>In <code>lubridate</code>, the <code><a href="https://lubridate.tidyverse.org/reference/as_date.html">as_date()</a></code> and <code><a href="https://lubridate.tidyverse.org/reference/as_date.html">as_datetime()</a></code> functions can be used to create date-times from other objects.</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="va">flights</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>date2 <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/as_date.html">as_date</a></span><span class="op">(</span><span class="va">datetime</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check that date and date2 are the same</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span><span class="op">(</span><span class="va">flights</span><span class="op">$</span><span class="va">date</span>, <span class="va">flights</span><span class="op">$</span><span class="va">date2</span><span class="op">)</span></span>
<span><span class="co">## [1] "Modes: numeric, NULL"                                </span></span>
<span><span class="co">## [2] "Lengths: 336776, 0"                                  </span></span>
<span><span class="co">## [3] "Attributes: &lt; Modes: list, NULL &gt;"                   </span></span>
<span><span class="co">## [4] "Attributes: &lt; Lengths: 1, 0 &gt;"                       </span></span>
<span><span class="co">## [5] "Attributes: &lt; names for target but not for current &gt;"</span></span>
<span><span class="co">## [6] "Attributes: &lt; current is not list-like &gt;"            </span></span>
<span><span class="co">## [7] "target is Date, current is NULL"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here’s a demonstration of epoch timekeeping.</p>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">current_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/now.html">now</a></span><span class="op">(</span>tzone <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span></span>
<span><span class="co"># This converts to the number of seconds since the Unix epoch</span></span>
<span><span class="va">seconds_since_epoch</span> <span class="op">&lt;-</span> <span class="va">current_time</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/period.html">seconds</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># Now let's convert back to a datetime</span></span>
<span><span class="op">(</span><span class="va">current_time2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/as_date.html">as_datetime</a></span><span class="op">(</span><span class="va">seconds_since_epoch</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] "2023-04-05 17:56:26 UTC"</span></span>
<span><span class="co"># Check to see that they're equal</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span><span class="op">(</span><span class="va">current_time</span>, <span class="va">current_time2</span><span class="op">)</span></span>
<span><span class="co">## [1] TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<p>In base R, we can use the <code>as.Date</code> function to create dates from datetimes.</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">flights</span><span class="op">$</span><span class="va">date2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="va">flights</span><span class="op">$</span><span class="va">date</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html">all.equal</a></span><span class="op">(</span><span class="va">flights</span><span class="op">$</span><span class="va">date</span>, <span class="va">flights</span><span class="op">$</span><span class="va">date2</span><span class="op">)</span></span>
<span><span class="co">## [1] TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can handle epochs as well:</p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Let's see what was 10000 days after the UNIX epoch</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="fl">1e4</span>, origin <span class="op">=</span> <span class="st">"1970-01-01"</span><span class="op">)</span></span>
<span><span class="co">## [1] "1997-05-19"</span></span>
<span></span>
<span><span class="co"># If we use as.POSIXct, we are counting in seconds from midnight</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="fl">1e4</span>, origin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="st">"1970-01-01 00:00:00"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] "1970-01-01 02:46:40 CST"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>By default, <code>as.POSIXct</code> will use the system’s time zone, which may not be desirable; you can always set the time zone yourself if you would like to do so.</p>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<p>In pandas, we can pass multiple columns to <code>pd.to_datetime()</code> and as long as they are named reasonably, pandas will handle the conversion. If we want to have the date but not the time for some reason, we just pass fewer columns to pandas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nycflights13 <span class="im">import</span> flights</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>flights[<span class="st">"date2"</span>] <span class="op">=</span> flights.date.dt.date <span class="co"># Convert datetime to date</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># They look the same</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>flights[[<span class="st">"date"</span>, <span class="st">"date2"</span>]]</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co">##              date       date2</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="co">## 0      2013-01-01  2013-01-01</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="co">## 1      2013-01-01  2013-01-01</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="co">## 2      2013-01-01  2013-01-01</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="co">## 3      2013-01-01  2013-01-01</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="co">## 4      2013-01-01  2013-01-01</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="co">## ...           ...         ...</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="co">## 336771 2013-09-30  2013-09-30</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="co">## 336772 2013-09-30  2013-09-30</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="co">## 336773 2013-09-30  2013-09-30</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="co">## 336774 2013-09-30  2013-09-30</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="co">## 336775 2013-09-30  2013-09-30</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="co">## </span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a><span class="co">## [336776 rows x 2 columns]</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>flights.dtypes</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a><span class="co"># date2 is an object, date is a datetime64.</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a><span class="co">## year                       int64</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a><span class="co">## month                      int64</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a><span class="co">## day                        int64</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a><span class="co">## dep_time                 float64</span></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a><span class="co">## sched_dep_time             int64</span></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a><span class="co">## dep_delay                float64</span></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a><span class="co">## arr_time                 float64</span></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a><span class="co">## sched_arr_time             int64</span></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a><span class="co">## arr_delay                float64</span></span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a><span class="co">## carrier                   object</span></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a><span class="co">## flight                     int64</span></span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a><span class="co">## tailnum                   object</span></span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a><span class="co">## origin                    object</span></span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a><span class="co">## dest                      object</span></span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a><span class="co">## air_time                 float64</span></span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a><span class="co">## distance                   int64</span></span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a><span class="co">## hour                       int64</span></span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a><span class="co">## minute                     int64</span></span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a><span class="co">## time_hour                 object</span></span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a><span class="co">## date              datetime64[ns]</span></span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a><span class="co">## datetime          datetime64[ns]</span></span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a><span class="co">## date2                     object</span></span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a><span class="co">## dtype: object</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We created <code>flights.date</code> using <code>pd.to_datetime()</code>. Given this comparison, it may be better to use to.datetime() and append <code>.dt.date</code> on the end if you do not want to keep the time information that is provided by default.</p>
</div>
</div>
</div>
</div>
</div>
</section></section><section id="working-with-dates-and-times" class="level2 page-columns page-full" data-number="23.5"><h2 data-number="23.5" class="anchored" data-anchor-id="working-with-dates-and-times">
<span class="header-section-number">23.5</span> Working with Dates and Times</h2>
<p>In this section, we’ll work with comments by famous Reddit artist <code>Shitty_Watercolour</code>, who responds to people’s comments with a quickly created watercolor-style painting.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Here’s one of Shitty Watercolour’s works: <img src="../images/wrangling/watercolor_example.jpeg" class="img-fluid" alt="A watercolor painting of a dog imagining touching a different dog through a laptop screen. The dogs apparently see each other once a month and facetime once a week."></p>
</div></div><div class="callout-demo callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Getting the Data
</div>
</div>
<div class="callout-body-container callout-body">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">R</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">Python</a></li>
</ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<p>Note: The textbook caches data, so your results may differ from those shown here because RedditExtractoR only acquires the last ~1000 comments from a user.</p>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># remotes::install_github("ivan-rivera/RedditExtractor")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">RedditExtractoR</span><span class="op">)</span></span>
<span></span>
<span><span class="va">comment_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RedditExtractoR/man/get_user_content.html">get_user_content</a></span><span class="op">(</span><span class="st">"Shitty_Watercolour"</span><span class="op">)</span></span>
<span><span class="va">watercolour</span> <span class="op">&lt;-</span> <span class="va">comment_list</span><span class="op">$</span><span class="va">Shitty_Watercolour</span><span class="op">$</span><span class="va">comments</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get data from R directly, since redditExtractor package is in R</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>watercolour <span class="op">=</span> r.watercolour</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<section id="time-zones" class="level3" data-number="23.5.1"><h3 data-number="23.5.1" class="anchored" data-anchor-id="time-zones">
<span class="header-section-number">23.5.1</span> Time Zones</h3>
<p>We often store data in UTC<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>, but we may want to represent the data in a more familiar time zone for interpretation’s purposes.</p>
<table class="table">
<caption>Working with Time Zones. Here, <code>time</code> is a placeholder for whatever variable is being converted.</caption>
<colgroup>
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 88%">
</colgroup>
<thead><tr class="header">
<th>Task</th>
<th>Language</th>
<th>Function</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Set the time zone</td>
<td>R</td>
<td><code>as_datetime(time, tz = "GMT")</code></td>
</tr>
<tr class="even">
<td></td>
<td>Python</td>
<td><code>time.apply(lambda x: pd.Timestamp(x).tz_localize("GMT"))</code></td>
</tr>
<tr class="odd">
<td>Display the time in a diff TZ</td>
<td>R</td>
<td><code>with_tz(time, tz = "America/Chicago")</code></td>
</tr>
<tr class="even">
<td></td>
<td>Python</td>
<td><code>time.apply(lambda x: pd.Timestamp(x).tz_convert("America/Chicago"))</code></td>
</tr>
</tbody>
</table>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Try it Out - Formatting Dates
</div>
</div>
<div class="callout-body-container callout-body">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">Problem</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">R Solution</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false">Python Solution</a></li>
</ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<p>The <code>watercolour</code> dataset above contains 959 comments from <code>Shitty_Watercolour</code>, with the UTC date and timestamp of the comment.</p>
<p>Figure out how to format these data into a proper date type and timestamp that is user-readable. Make sure you inform R or python that the timestamp is provided in UTC.</p>
<p><img src="../images/wrangling/reddit-timestamp-mouseover.png" class="img-fluid" alt="Hovering over the time on a reddit comment will produce a popup showing the full time that the comment was posted."> Compare a couple of your timestamps to the timestamps provided by Reddit when you mouse over a comment.</p>
<p>Can you get R or Python to output the date in your timezone?</p>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">watercolour</span> <span class="op">&lt;-</span> <span class="va">watercolour</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>date <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="va">date_utc</span>, tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span>,</span>
<span>         time <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/as_date.html">as_datetime</a></span><span class="op">(</span><span class="va">timestamp</span><span class="op">)</span>,</span>
<span>         time_cst <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/with_tz.html">with_tz</a></span><span class="op">(</span><span class="va">time</span>, tzone_out <span class="op">=</span> <span class="st">"CST"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">watercolour</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"date"</span>, <span class="st">"time"</span>, <span class="st">"time_cst"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">## # A tibble: 959 × 3</span></span>
<span><span class="co">##    date                time                time_cst           </span></span>
<span><span class="co">##    &lt;dttm&gt;              &lt;dttm&gt;              &lt;dttm&gt;             </span></span>
<span><span class="co">##  1 2017-12-19 00:00:00 2017-12-19 22:08:19 2017-12-19 16:08:19</span></span>
<span><span class="co">##  2 2017-12-19 00:00:00 2017-12-19 22:07:03 2017-12-19 16:07:03</span></span>
<span><span class="co">##  3 2017-12-19 00:00:00 2017-12-19 20:47:55 2017-12-19 14:47:55</span></span>
<span><span class="co">##  4 2017-12-19 00:00:00 2017-12-19 20:01:19 2017-12-19 14:01:19</span></span>
<span><span class="co">##  5 2017-12-17 00:00:00 2017-12-17 19:58:51 2017-12-17 13:58:51</span></span>
<span><span class="co">##  6 2017-12-15 00:00:00 2017-12-15 02:53:23 2017-12-14 20:53:23</span></span>
<span><span class="co">##  7 2017-12-12 00:00:00 2017-12-12 16:56:23 2017-12-12 10:56:23</span></span>
<span><span class="co">##  8 2017-12-08 00:00:00 2017-12-08 17:48:05 2017-12-08 11:48:05</span></span>
<span><span class="co">##  9 2017-12-08 00:00:00 2017-12-08 03:50:17 2017-12-07 21:50:17</span></span>
<span><span class="co">## 10 2017-12-07 00:00:00 2017-12-07 18:00:58 2017-12-07 12:00:58</span></span>
<span><span class="co">## # ℹ 949 more rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>watercolour[<span class="st">"date"</span>] <span class="op">=</span> pd.to_datetime(watercolour.date_utc).dt.date</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>watercolour[<span class="st">"time"</span>] <span class="op">=</span> pd.to_datetime(watercolour.timestamp, unit <span class="op">=</span> <span class="st">'s'</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell Python the time is in UTC </span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>watercolour[<span class="st">"time"</span>] <span class="op">=</span> watercolour.time.<span class="bu">apply</span>(<span class="kw">lambda</span> x: pd.Timestamp(x).tz_localize(<span class="st">"UTC"</span>))</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>watercolour[<span class="st">"time_cst"</span>] <span class="op">=</span> watercolour.time.<span class="bu">apply</span>(<span class="kw">lambda</span> x: pd.Timestamp(x).tz_convert(<span class="st">"US/Central"</span>))</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>watercolour[[<span class="st">"date"</span>, <span class="st">"time"</span>, <span class="st">"time_cst"</span>]]</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="co">##            date                      time                  time_cst</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="co">## 0    2017-12-19 2017-12-19 22:08:19+00:00 2017-12-19 16:08:19-06:00</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="co">## 1    2017-12-19 2017-12-19 22:07:03+00:00 2017-12-19 16:07:03-06:00</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="co">## 2    2017-12-19 2017-12-19 20:47:55+00:00 2017-12-19 14:47:55-06:00</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="co">## 3    2017-12-19 2017-12-19 20:01:19+00:00 2017-12-19 14:01:19-06:00</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a><span class="co">## 4    2017-12-17 2017-12-17 19:58:51+00:00 2017-12-17 13:58:51-06:00</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a><span class="co">## ..          ...                       ...                       ...</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a><span class="co">## 954  2023-02-21 2023-02-21 16:55:03+00:00 2023-02-21 10:55:03-06:00</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a><span class="co">## 955  2023-02-21 2023-02-21 15:59:51+00:00 2023-02-21 09:59:51-06:00</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a><span class="co">## 956  2023-02-21 2023-02-21 15:09:19+00:00 2023-02-21 09:09:19-06:00</span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a><span class="co">## 957  2023-02-21 2023-02-21 14:45:10+00:00 2023-02-21 08:45:10-06:00</span></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a><span class="co">## 958  2023-02-21 2023-02-21 11:27:52+00:00 2023-02-21 05:27:52-06:00</span></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a><span class="co">## </span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a><span class="co">## [959 rows x 3 columns]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section id="time-spans" class="level3" data-number="23.5.2"><h3 data-number="23.5.2" class="anchored" data-anchor-id="time-spans">
<span class="header-section-number">23.5.2</span> Time Spans</h3>
<p>Dates and times can be added and subtracted - after all, underneath, they’re usually implemented as a number of XXX from the reference time point, where XXX is usually seconds for datetimes and days for dates.</p>
<p>In R, the difference between two timestamps is called a <strong>duration</strong> and is implemented in the <strong>duration</strong> class <span class="citation" data-cites="r4ds">See <a href="#ref-r4ds" role="doc-biblioref">[11, Ch. 16.4.1]</a> for more info</span>. In Python, a similar class exists and is called a <strong>timedelta</strong> <span class="citation" data-cites="pythonfoundationDatetimeBasicDate2023"><a href="#ref-pythonfoundationDatetimeBasicDate2023" role="doc-biblioref">[12]</a></span>.</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Try it Out - Datetime Math
</div>
</div>
<div class="callout-body-container callout-body">
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">Problem</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">R Solution</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false">Python Solution</a></li>
</ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<p>Use the <code>watercolour</code> data and plot the interval between successive <code>Shitty_Watercolour</code> posts in minutes. What can you conclude?</p>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">watercolour</span> <span class="op">&lt;-</span> <span class="va">watercolour</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>diff <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/as.duration.html">as.duration</a></span><span class="op">(</span><span class="va">time</span> <span class="op">-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html">lag</a></span><span class="op">(</span><span class="va">time</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>         diffmin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">diff</span>, <span class="st">"minutes"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">watercolour</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">diffmin</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Time between posts (minutes)"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"# Posts"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_log10</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">15</span>, <span class="fl">30</span>, <span class="fl">60</span>, <span class="fl">1440</span>, <span class="fl">10080</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07-datetime_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="2100"></p>
</div>
</div>
<p>Most of the time, <code>Shitty_Watercolour</code> takes at least 15 minutes to generate a new comment. There is also a noticable peak just before 1440 minutes, indicating that as with most users, <code>Shitty_Watercolour</code> is active at approximately the same time each day for a few hours. The final break shown, 10080, is the number of minutes in a week, indicating that occasionally, <code>Shitty_Watercolour</code> goes more than a week between posts.</p>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>watercolour <span class="op">=</span> watercolour.sort_values(by <span class="op">=</span> <span class="st">'time'</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>watercolour[<span class="st">"diff"</span>] <span class="op">=</span> watercolour.time.diff().astype(<span class="st">'timedelta64'</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># This formats in minutes</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>watercolour[<span class="st">"diffmin"</span>] <span class="op">=</span> watercolour.time.diff().astype(<span class="st">'timedelta64[m]'</span>)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove negative minutes - something funky there?</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>watercolour <span class="op">=</span> watercolour.query(<span class="st">"diffmin &gt; 0"</span>)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn.objects <span class="im">as</span> so</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> (</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  so.</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  Plot(watercolour, watercolour[<span class="st">"diffmin"</span>]).</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  add(so.Bars(width<span class="op">=</span><span class="fl">.95</span>), so.Hist(bins <span class="op">=</span> <span class="dv">30</span>)).</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  scale(x <span class="op">=</span> so.Continuous(trans <span class="op">=</span> <span class="st">"log"</span>).</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>    tick(at <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">15</span>, <span class="dv">30</span>, <span class="dv">60</span>, <span class="dv">1440</span>, <span class="dv">10080</span>]).</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>    label(like<span class="op">=</span><span class="st">"</span><span class="sc">{x:d}</span><span class="st">"</span>)).</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  label(x <span class="op">=</span> <span class="st">"Time between posts (minutes)"</span>, y <span class="op">=</span> <span class="st">"# Posts"</span>)</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>p.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="07-datetime_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="614"></p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section></section><section id="references" class="level2" data-number="23.6"><h2 data-number="23.6" class="anchored" data-anchor-id="references">
<span class="header-section-number">23.6</span> References</h2>


<div id="refs" class="references csl-bib-body" role="doc-bibliography">
<div id="ref-freewindWhySubtractingThese2021" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[1] </div>
<div class="csl-right-inline">Freewind, <span>“Why is subtracting these two times (in 1927) giving a strange result? Stack overflow,”</span> May 22, 2021. [Online]. Available: <a href="https://stackoverflow.com/q/6841333/2859168">https://stackoverflow.com/q/6841333/2859168</a>. [Accessed: Jan. 21, 2023]</div>
</div>
<div id="ref-skeetAnswerWhySubtracting2011" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[2] </div>
<div class="csl-right-inline">J. Skeet, <span>“Answer to "why is subtracting these two times (in 1927) giving a strange result?". Stack overflow,”</span> Jul. 27, 2011. [Online]. Available: <a href="https://stackoverflow.com/a/6841479/2859168">https://stackoverflow.com/a/6841479/2859168</a>. [Accessed: Jan. 21, 2023]</div>
</div>
<div id="ref-borgwardtAnswerWhySubtracting2011" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[3] </div>
<div class="csl-right-inline">M. Borgwardt, <span>“Answer to "why is subtracting these two times (in 1927) giving a strange result?". Stack overflow,”</span> Jul. 27, 2011. [Online]. Available: <a href="https://stackoverflow.com/a/6841572/2859168">https://stackoverflow.com/a/6841572/2859168</a>. [Accessed: Jan. 21, 2023]</div>
</div>
<div id="ref-grolemundDatesTimes" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[4] </div>
<div class="csl-right-inline">H. W. {and}. G. Grolemund, <span>“Dates and times,”</span> in <em>R for data science</em>, 1st ed., O’Reilly Media, p. 518 [Online]. Available: <a href="https://r4ds.had.co.nz/dates-and-times.html">https://r4ds.had.co.nz/dates-and-times.html</a>. [Accessed: Jan. 23, 2023]</div>
</div>
<div id="ref-wikipediacontributorsEpochComputing2023" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[5] </div>
<div class="csl-right-inline">Wikipedia contributors, <span>“Epoch (computing),”</span> <em>Wikipedia</em>. Mar. 23, 2023 [Online]. Available: <a href="https://en.wikipedia.org/w/index.php?title=Epoch_(computing)&amp;oldid=1146251518">https://en.wikipedia.org/w/index.php?title=Epoch_(computing)&amp;oldid=1146251518</a>. [Accessed: Apr. 04, 2023]</div>
</div>
<div id="ref-microsoftsupportDATEVALUEFunctionMicrosoft2023" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[6] </div>
<div class="csl-right-inline">Microsoft Support, <span>“<span>DATEVALUE</span> function - <span>Microsoft Support</span>,”</span> 2023. [Online]. Available: <a href="https://support.microsoft.com/en-us/office/datevalue-function-df8b07d4-7761-4a93-bc33-b7471bbff252">https://support.microsoft.com/en-us/office/datevalue-function-df8b07d4-7761-4a93-bc33-b7471bbff252</a>. [Accessed: Apr. 04, 2023]</div>
</div>
<div id="ref-elizabethmottWhyDatesCome2013" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[7] </div>
<div class="csl-right-inline">Elizabeth Mott, <span>“Why <span>Do Dates Come</span> in <span>Different</span> in <span>Excel From</span> a <span>Mac</span> to a <span>PC</span>?”</span> Jun. 12, 2013. [Online]. Available: <a href="https://smallbusiness.chron.com/dates-come-different-excel-mac-pc-68917.html">https://smallbusiness.chron.com/dates-come-different-excel-mac-pc-68917.html</a>. [Accessed: Apr. 04, 2023]</div>
</div>
<div id="ref-caudillExcelHellCautionary2018" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[8] </div>
<div class="csl-right-inline">H. Caudill, <span>“Excel <span>Hell</span>: <span>A</span> cautionary tale,”</span> Dec. 19, 2018. [Online]. Available: <a href="https://medium.com/all-the-things/a-single-infinitely-customizable-app-for-everything-else-9abed7c5b5e7">https://medium.com/all-the-things/a-single-infinitely-customizable-app-for-everything-else-9abed7c5b5e7</a>. [Accessed: Apr. 04, 2023]</div>
</div>
<div id="ref-chris88888888ExcelStillSucks2020" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[9] </div>
<div class="csl-right-inline">Chris88888888, <span>“Excel <span>Still Sucks</span> at <span>Recognizing Dates</span>.”</span> Apr. 15, 2020. [Online]. Available: <a href="https://answers.microsoft.com/en-us/msoffice/forum/all/excel-still-sucks-at-recognizing-dates/5305f6db-8211-49d5-932d-c4871df27fc7">https://answers.microsoft.com/en-us/msoffice/forum/all/excel-still-sucks-at-recognizing-dates/5305f6db-8211-49d5-932d-c4871df27fc7</a>. [Accessed: Apr. 04, 2023]</div>
</div>
<div id="ref-vincentScientistsRenameHuman2020" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[10] </div>
<div class="csl-right-inline">J. Vincent, <span>“Scientists rename human genes to stop <span>Microsoft Excel</span> from misreading them as dates,”</span> Aug. 06, 2020. [Online]. Available: <a href="https://www.theverge.com/2020/8/6/21355674/human-genes-rename-microsoft-excel-misreading-dates">https://www.theverge.com/2020/8/6/21355674/human-genes-rename-microsoft-excel-misreading-dates</a>. [Accessed: Apr. 04, 2023]</div>
</div>
<div id="ref-r4ds" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[11] </div>
<div class="csl-right-inline">G. Grolemund and H. Wickham, <em>R for <span>Data</span> <span>Science</span></em>, 1st ed. O’Reilly Media, 2017 [Online]. Available: <a href="https://r4ds.had.co.nz/">https://r4ds.had.co.nz/</a>. [Accessed: May 09, 2022]</div>
</div>
<div id="ref-pythonfoundationDatetimeBasicDate2023" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[12] </div>
<div class="csl-right-inline">Python Foundation, <span>“Datetime <span>Basic</span> date and time types,”</span> Apr. 05, 2023. [Online]. Available: <a href="https://docs.python.org/3/library/datetime.html">https://docs.python.org/3/library/datetime.html</a>. [Accessed: Apr. 05, 2023]</div>
</div>
</div>
</section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>Coordinated Universal Time, but the acronym is in a different language and the words are thus in a different order.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><script src="https://giscus.app/client.js" data-repo="srvanderplas/stat-computing-r-python" data-repo-id="R_kgDOIvwd2g" data-category="General" data-category-id="DIC_kwDOIvwd2s4CTksR" data-mapping="pathname" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../part-wrangling/06-data-join.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Joining Data</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../part-wrangling/08-functional-prog.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Functional Programming</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">Copyright 2023, Susan Vanderplas</div>   
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/srvanderplas">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/srvanderplas">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
</ul>
</div>
  </div>
</footer>


</body></html>